<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>汽车销售数据关系图</title>
    <script src="https://lib.baomitu.com/echarts/5.2.0/echarts.js"></script>
    <style>
        body {
            background-color: #111;
            color: #fff;
            text-align: center;
            font-family: "Microsoft YaHei", sans-serif;
            margin: 0;
            padding: 20px;
        }

        h1 {
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        #hoverInfo {
            margin: 10px auto 20px;
            font-size: 18px;
            color: #fff;
            height: 24px;
            min-height: 24px;
        }

        #main {
            width: 100%;
            height: 800px;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <h1>汽车销售数据关系图</h1>
    <div id="hoverInfo">鼠标悬停查看销量</div>
    <div id="main"></div>

    <script>
        // 模拟数据 - 实际使用时替换为你的API请求
        const mockCarData = [
            { name: "特斯拉 Model 3", value: 500000 },
            { name: "比亚迪 汉", value: 450000 },
            { name: "丰田 卡罗拉", value: 400000 },
            { name: "本田 雅阁", value: 380000 },
            { name: "大众 帕萨特", value: 350000 },
            { name: "日产 轩逸", value: 330000 },
            { name: "宝马 3系", value: 300000 },
            { name: "奔驰 C级", value: 280000 },
            { name: "奥迪 A4", value: 260000 },
            { name: "现代 索纳塔", value: 240000 },
            { name: "吉利 帝豪", value: 220000 },
            { name: "长安 CS75", value: 200000 },
            { name: "哈弗 H6", value: 180000 },
            { name: "五菱 宏光", value: 160000 },
            { name: "蔚来 ES6", value: 140000 },
            { name: "小鹏 P7", value: 120000 },
            { name: "理想 ONE", value: 100000 }
        ];

        // 初始化图表
        var myChart = echarts.init(document.getElementById('main'));

        // 颜色列表
        var colorList = [
            '#929fff', '#9de0ff', '#ffa897', '#af87fe', '#7dc3fe',
            '#bb60b2', '#433e7c', '#f47a75', '#009db2', '#024b51',
            '#0780cf', '#765005', '#e75840', '#26ccd8', '#3685fe',
            '#9977ef', '#f5616f', '#f7b13f', '#f9e264', '#50c48f'
        ];

        // 处理数据 - 计算大小和颜色
        const maxSales = Math.max(...mockCarData.map(item => item.value));
        const minSales = Math.min(...mockCarData.map(item => item.value));

        const nodes = mockCarData.map((item, index) => {
            // 计算大小 (30-100之间)
            const size = 30 + (item.value - minSales) / (maxSales - minSales) * 70;

            return {
                name: item.name,
                value: item.value,
                symbolSize: size,
                itemStyle: {
                    color: colorList[index % colorList.length]
                },
                label: {
                    show: true,
                    formatter: '{b}'
                }
            };
        });

        // 生成一些随机关系
        const links = [];
        for (let i = 0; i < nodes.length; i++) {
            // 每个节点连接1-3个其他节点
            const linkCount = Math.floor(Math.random() * 3) + 1;
            for (let j = 0; j < linkCount; j++) {
                const targetIndex = Math.floor(Math.random() * nodes.length);
                if (targetIndex !== i) {
                    links.push({
                        source: i,
                        target: targetIndex
                    });
                }
            }
        }

        // 配置项
        var option = {
            backgroundColor: '#000',
            title: {
                text: '汽车销售数据关系图',
                left: 'center',
                bottom: 10,
                textStyle: {
                    color: '#fff',
                    fontSize: 18
                }
            },
            tooltip: {
                formatter: function (params) {
                    if (params.dataType === 'node') {
                        return `${params.data.name}<br/>销量: ${params.data.value.toLocaleString()}辆`;
                    }
                    return '';
                }
            },
            animationDurationUpdate: 1500,
            animationEasingUpdate: 'quinticInOut',
            series: [{
                type: 'graph',
                layout: 'force',
                force: {
                    repulsion: 200,
                    edgeLength: 100,
                    gravity: 0.1
                },
                roam: true,
                focusNodeAdjacency: true,
                draggable: true,
                data: nodes,
                links: links,
                categories: [],
                label: {
                    position: 'right',
                    show: true,
                    color: '#fff',
                    formatter: '{b}'
                },
                lineStyle: {
                    color: 'source',
                    curveness: 0.3,
                    opacity: 0.5
                },
                emphasis: {
                    lineStyle: {
                        width: 2
                    }
                }
            }]
        };

        // 使用配置项显示图表
        myChart.setOption(option);

        // 鼠标悬停事件 - 显示在顶部信息栏
        myChart.on('mouseover', function (params) {
            if (params.dataType === 'node') {
                const hoverInfo = document.getElementById('hoverInfo');
                hoverInfo.textContent = `${params.data.name}：${params.data.value.toLocaleString()}辆`;
                hoverInfo.style.color = params.data.itemStyle.color;
            }
        });

        myChart.on('mouseout', function () {
            const hoverInfo = document.getElementById('hoverInfo');
            hoverInfo.textContent = "鼠标悬停查看销量";
            hoverInfo.style.color = "#fff";
        });

        // 点击事件 - 可以跳转到相关页面
        myChart.on('click', function (params) {
            if (params.dataType === 'node') {
                console.log(params.data.name);
                // 实际使用时可以跳转到相关页面
                // window.open('https://www.baidu.com/s?wd=' + encodeURIComponent(params.data.name));
            }
        });

        // 窗口大小变化时调整图表大小
        window.addEventListener('resize', function () {
            myChart.resize();
        });
    </script>
</body>

</html>